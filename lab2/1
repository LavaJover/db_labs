SELECT NAME,
	GOODS_COUNT
FROM COMPANY_PROVIDER
INNER JOIN
	(SELECT PROVIDER_ID,
			GOODS_COUNT
		FROM SUPPLY
		INNER JOIN
			(SELECT SUPPLY_ID,
					GOODS_COUNT
				FROM SUPPLY_CONSIST
				INNER JOIN
					(SELECT SUPPLY_CONSIST_ID,
							COUNT(GOODS_ID) AS GOODS_COUNT
						FROM GOODS
						GROUP BY(SUPPLY_CONSIST_ID)) AS GOODS_TAB ON SUPPLY_CONSIST.SUPPLY_CONSIST_ID = GOODS_TAB.SUPPLY_CONSIST_ID) AS SUPPLY_TAB ON SUPPLY.SUPPLY_ID = SUPPLY_TAB.SUPPLY_ID) AS PROVIDER_TAB ON PROVIDER_TAB.PROVIDER_ID = COMPANY_PROVIDER.PROVIDER_ID;

