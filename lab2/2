SELECT company_provider.name, ans.name, min_price
FROM
company_provider
INNER JOIN
(SELECT provider_id, name, min_price
FROM
supply
INNER JOIN
(SELECT supply_id, name, min_price
FROM
supply_consist
INNER JOIN
(SELECT goods.supply_consist_id, goods_min.name, min_price
FROM
goods
INNER JOIN
(SELECT name, MIN(price) as min_price
FROM
goods
GROUP BY name) as goods_min ON goods.name=goods_min.name AND goods.price=min_price) AS supply_min ON supply_consist.supply_consist_id=supply_min.supply_consist_id) AS provider_min ON supply.supply_id=provider_min.supply_id) AS ans ON ans.provider_id=company_provider.provider_id;

